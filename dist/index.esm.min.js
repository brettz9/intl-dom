function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(a,!0).forEach((function(r){t(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o,s=(function(e,t){const r=-1,n=0,a=1,i=2,o=3,s=4,u=5,l=6,c=7,f=8,p=9,h=10,g=11,v=13,d=0,b=[];function y(){var e=b.pop();return e||(e={context:d,elements:null,element_array:null}),e}function m(e){b.push(e)}const w=[];function k(e){w.push(e)}var F=t;F.escape=function(e){var t,r="";if(!e)return e;for(t=0;t<e.length;t++)'"'!=e[t]&&"\\"!=e[t]&&"`"!=e[t]&&"'"!=e[t]||(r+="\\"),r+=e[t];return r},F.begin=function(e,t){const b={name:null,value_type:n,string:"",contains:null},F={line:1,col:1};let x,D=0;var S=0,j=!0,E=!1,_=null,O=void 0,A=[],P={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t},pop(){var e=this.last;return e?((this.last=e.prior)||(this.first=null),e.next=this.saved,this.saved=e,e.node):null}},T=d,N=0,C=!1,B=!1,R=!1,I=!1,M=!1,$={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t},shift(){var e=this.first;return e?((this.first=e.next)||(this.last=null),e.next=this.saved,this.saved=e,e.node):null},unshift(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=this.first,t.prior=null):t={node:e,next:this.first,prior:null},this.first||(this.last=t),this.first=t}},L=null,U=!1,q=!1,K=!1,z=!1,V=!1,W=!1,J=!1,G=0,H=0,Q=!1,X=!1;return{value(){var e=_;return _=void 0,e},reset(){S=0,j=!0,$.last&&($.last.next=$.save),$.save=$.first,$.first=$.last=null,P.last&&(P.last.next=P.save),P.save=$.first,P.first=P.last=null,A=null,O=void 0,T=d,b.value_type=n,b.name=null,b.string="",F.line=1,F.col=1,E=!1,N=0,X=!1,U=!1,K=!1,z=!1},write(r){var n;for("string"!=typeof r&&(r=String(r)),n=this._write(r,!1);n>0&&(_&&("function"==typeof t&&function e(r,n){var a,i,o=r[n];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(void 0!==(i=e(o,a))?o[a]=i:delete o[a]);return t.call(r,n,o)}({"":_},""),e(_),_=void 0),!(n<2));n=this._write());},_write(e,t){var Y,Z,ee,te=0;function re(e,t){throw new Error(`${e} '${String.fromCodePoint(t)}' unexpected at ${D} (near '${ee.substr(D>4?D-4:0,D>4?3:D-1)}[${String.fromCodePoint(t)}]${ee.substr(D,10)}') [${F.line}:${F.col}]`)}function ne(){b.value_type=n,b.string=""}function ae(e){return e.length>1&&!C&&!B&&!R&&48===e.charCodeAt(0)?(E?-1:1)*Number("0o"+e):(E?-1:1)*Number(e)}function ie(){switch(b.value_type){case u:A.push(ae(b.string));break;case s:A.push(b.string);break;case i:A.push(!0);break;case o:A.push(!1);break;case f:case p:A.push(NaN);break;case h:A.push(-1/0);break;case g:A.push(1/0);break;case a:A.push(null);break;case r:A.push(void 0);break;case v:A.push(void 0),delete A[A.length-1];break;case l:case c:A.push(b.contains);break;default:console.log("Unhandled array push.")}}function oe(){switch(b.value_type){case u:O[b.name]=ae(b.string);break;case s:O[b.name]=b.string;break;case i:O[b.name]=!0;break;case o:O[b.name]=!1;break;case f:case p:O[b.name]=NaN;break;case h:O[b.name]=-1/0;break;case g:O[b.name]=1/0;break;case a:O[b.name]=null;break;case r:O[b.name]=void 0;break;case l:case c:O[b.name]=b.contains}}function se(e){let t=0;for(;0==t&&D<ee.length;){x=ee.charAt(D);let r=ee.codePointAt(D++);if(r>=65536&&(x+=ee.charAt(D),D++),F.col++,r==e)K?(b.string+=x,K=!1):(t=-1,Q?re("Incomplete Octal sequence",r):J?re("Incomplete hexidecimal sequence",r):W?re("Incomplete unicode sequence",r):V&&re("Incomplete long unicode sequence",r),t=1);else if(K){if(Q){if(H<3&&r>=48&&r<=57){if(G*=8,G+=r-48,3==++H){b.string+=String.fromCodePoint(G),Q=!1,K=!1;continue}continue}if(G>255){re("(escaped character, parsing octal escape val=%d) fault while parsing",r),t=-1;break}b.string+=String.fromCodePoint(G),Q=!1,K=!1;continue}if(V){if(125==r){b.string+=String.fromCodePoint(G),V=!1,W=!1,K=!1;continue}if(G*=16,r>=48&&r<=57)G+=r-48;else if(r>=65&&r<=70)G+=r-65+10;else{if(!(r>=97&&r<=102)){re("(escaped character, parsing hex of \\u)",r),t=-1,V=!1,K=!1;continue}G+=r-97+10}continue}if(J||W){if(0===H&&123===r){V=!0;continue}if(H<2||W&&H<4){if(G*=16,r>=48&&r<=57)G+=r-48;else if(r>=65&&r<=70)G+=r-65+10;else{if(!(r>=97&&r<=102)){re(W?"(escaped character, parsing hex of \\u)":"(escaped character, parsing hex of \\x)",r),t=-1,J=!1,K=!1;continue}G+=r-97+10}H++,W?4==H&&(b.string+=String.fromCodePoint(G),W=!1,K=!1):2==H&&(b.string+=String.fromCodePoint(G),J=!1,K=!1);continue}}switch(r){case 13:z=!0,F.col=1;continue;case 10:case 2028:case 2029:F.line++;break;case 116:b.string+="\t";break;case 98:b.string+="\b";break;case 110:b.string+="\n";break;case 114:b.string+="\r";break;case 102:b.string+="\f";break;case 48:case 49:case 50:case 51:Q=!0,G=r-48,H=1;continue;case 120:J=!0,H=0,G=0;continue;case 117:W=!0,H=0,G=0;continue;default:b.string+=x}K=!1}else if(92===r)K?(b.string+="\\",K=!1):K=!0;else{if(z){if(z=!1,10==r){F.line++,F.col=1,K=!1;continue}F.line++,F.col=1;continue}b.string+=x}}return t}function ue(){let e;for(;(e=D)<ee.length;){x=ee.charAt(e);let r=ee.codePointAt(D++);if(r>=65536&&(re("fault while parsing number;",r),x+=ee.charAt(D),D++),95!=r)if(F.col++,r>=48&&r<=57)R&&(M=!0),b.string+=x;else if(45==r||43==r){if(0!=b.string.length&&(!R||I||M)){j=!1,re("fault while parsing number;",r);break}b.string+=x,I=!0}else if(46==r){if(B||C||R){j=!1,re("fault while parsing number;",r);break}b.string+=x,B=!0}else if(120==r||98==r||111==r||88==r||66==r||79==r){if(C||"0"!=b.string){j=!1,re("fault while parsing number;",r);break}C=!0,b.string+=x}else{if(101!=r&&69!=r){if(32==r||13==r||10==r||9==r||65279==r||44==r||125==r||93==r||58==r)break;t&&(j=!1,re("fault while parsing number;",r));break}if(R){j=!1,re("fault while parsing number;",r);break}b.string+=x,R=!0}}D=e,t||D!=ee.length?(q=!1,b.value_type=u,T==d&&(X=!0)):q=!0}if(!j)return-1;for(e&&e.length?((Z=function(){var e=w.pop();return e?e.n=0:e={buf:null,n:0},e}()).buf=e,$.push(Z)):q&&(q=!1,b.value_type=u,T==d&&(X=!0),te=1);j&&(Z=$.shift());){if(D=Z.n,ee=Z.buf,U){let e=se(L);e<0?j=!1:e>0&&(U=!1,j&&(b.value_type=s))}for(q&&ue();!X&&j&&D<ee.length;){if(x=ee.charAt(D),(Y=ee.codePointAt(D++))>=65536&&(x+=ee.charAt(D),D++),F.col++,N){if(1==N){if(42==Y){N=3;continue}47!=Y?(re("fault while parsing;",Y),j=!1):N=2;continue}if(2==N){if(10==Y){N=0;continue}continue}if(3==N){if(42==Y){N=4;continue}continue}if(4==N){if(47==Y){N=0;continue}42!=Y&&(N=3);continue}}switch(Y){case 47:N||(N=1);break;case 123:if(29==S||30==S||3==T&&0==S){re("fault while parsing; getting field name unexpected ",Y),j=!1;break}{let e=y();b.value_type=l;let t={};T==d?_=O=t:4==T&&(O[b.name]=t),e.context=T,e.elements=O,e.element_array=A,e.name=b.name,O=t,P.push(e),ne(),T=3}break;case 91:if(3==T||29==S||30==S){re("Fault while parsing; while getting field name unexpected",Y),j=!1;break}{let e=y();b.value_type=c;let t=[];T==d?_=A=t:4==T&&(O[b.name]=t),e.context=T,e.elements=O,e.element_array=A,e.name=b.name,A=t,P.push(e),ne(),T=1}break;case 58:if(3==T){if(0!=S&&29!=S&&30!=S){j=FALSE,thorwError(`fault while parsing; unquoted keyword used as object field name (state:${S})`,Y);break}S=0,b.name=b.string,b.string="",T=4,b.value_type=n}else re(1==T?"(in array, got colon out of string):parsing fault;":"(outside any object, got colon out of string):parsing fault;",Y),j=!1;break;case 125:if(31==S&&(S=0),3==T){ne();let e=P.pop();T=e.context,O=e.elements,A=e.element_array,m(e),T==d&&(X=!0)}else if(4==T){b.value_type!=n&&oe(),b.value_type=l,b.contains=O;var le=P.pop();b.name=le.name,T=le.context,O=le.elements,A=le.element_array,m(le),T==d&&(X=!0)}else re("Fault while parsing; unexpected",Y),j=!1;E=!1;break;case 93:31==S&&(S=0),1==T?(b.value_type!=n&&ie(),b.value_type=c,b.contains=A,le=P.pop(),b.name=le.name,T=le.context,O=le.elements,A=le.element_array,m(le),T==d&&(X=!0)):(re(`bad context ${T}; fault while parsing`,Y),j=!1),E=!1;break;case 44:31==S&&(S=0),1==T?(b.value_type==n&&(b.value_type=v),b.value_type!=n&&(ie(),ne())):4==T?(T=3,b.value_type!=n&&(oe(),ne())):(j=!1,re("bad context; excessive commas while parsing;",Y)),E=!1;break;default:if(3==T)switch(Y){case 96:case 34:case 39:0==S?se(Y)?b.value_type=s:(L=Y,U=!0):re("fault while parsing; quote not at start of field name",Y);break;case 10:F.line++,F.col=1;case 13:case 32:case 9:case 65279:if(31==S){S=0,T==d&&(X=!0);break}if(0==S||30==S)break;29==S?S=30:(j=!1,re("fault while parsing; whitepsace unexpected",Y));break;default:30==S&&(j=!1,re("fault while parsing; character unexpected",Y)),0==S&&(S=29),b.string+=x}else switch(Y){case 96:case 34:case 39:se(Y)?(b.value_type=s,S=31):(L=Y,U=!0);break;case 10:F.line++,F.col=1;case 32:case 9:case 13:case 65279:if(31==S){S=0,T==d&&(X=!0);break}if(0==S)break;29==S?S=30:(j=!1,re("fault parsing whitespace",Y));break;case 116:0==S?S=1:27==S?S=28:(j=!1,re("fault parsing",Y));break;case 114:1==S?S=2:(j=!1,re("fault parsing",Y));break;case 117:2==S?S=3:9==S?S=10:0==S?S=12:(j=!1,re("fault parsing",Y));break;case 101:3==S?(b.value_type=i,S=31):8==S?(b.value_type=o,S=31):14==S?S=15:18==S?S=19:(j=!1,re("fault parsing",Y));break;case 110:0==S?S=9:12==S?S=13:17==S?S=18:22==S?S=23:25==S?S=26:(j=!1,re("fault parsing",Y));break;case 100:13==S?S=14:19==S?(b.value_type=r,S=31):(j=!1,re("fault parsing",Y));break;case 105:16==S?S=17:24==S?S=25:26==S?S=27:(j=!1,re("fault parsing",Y));break;case 108:10==S?S=11:11==S?(b.value_type=a,S=31):6==S?S=7:(j=!1,re("fault parsing",Y));break;case 102:0==S?S=5:15==S?S=16:23==S?S=24:(j=!1,re("fault parsing",Y));break;case 97:5==S?S=6:20==S?S=21:(j=!1,re("fault parsing",Y));break;case 115:7==S?S=8:(j=!1,re("fault parsing",Y));break;case 73:0==S?S=22:(j=!1,re("fault parsing",Y));break;case 78:0==S?S=20:21==S?(b.value_type=E?f:p,E=!1,S=31):(j=!1,re("fault parsing",Y));break;case 121:28==S?(b.value_type=E?h:g,E=!1,S=31):(j=!1,re("fault parsing",Y));break;case 45:0==S?E=!E:(j=!1,re("fault parsing",Y));break;default:Y>=48&&Y<=57||43==Y||46==Y||45==Y?(C=!1,R=!1,I=!1,M=!1,B=!1,b.string=x,Z.n=D,ue()):(j=!1,re("fault parsing",Y))}}if(X){31==S&&(S=0);break}}if(D==ee.length?(k(Z),U||q||3==T?te=0:T!=d||b.value_type==n&&!_||(X=!0,te=1)):(Z.n=D,$.unshift(Z),te=2),X)break}if(!j)return-1;if(X&&b.value_type!=n){switch(b.value_type){case u:_=ae(b.string);break;case s:_=b.string;break;case i:_=!0;break;case o:_=!1;break;case a:_=null;break;case r:_=void 0;break;case p:case f:_=NaN;break;case g:_=1/0;break;case h:_=-1/0;break;case l:case c:_=b.contains}E=!1,b.string="",b.value_type=n}return X=!1,te}}};const x=[Object.freeze(F.begin())];var D=0;F.parse=function(e,t){var r,n=D++;if(x.length<=n&&x.push(Object.freeze(F.begin())),r=x[n],"string"!=typeof e&&(e=String(e)),r.reset(),r._write(e,!0)>0){var a=r.value();return"function"==typeof t&&function e(r,n){var a,i,o=r[n];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(void 0!==(i=e(o,a))?o[a]=i:delete o[a]);return t.call(r,n,o)}({"":a},""),D--,a}},F.stringify=JSON.stringify}(o={exports:{}},o.exports),o.exports);function u(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function l(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function c(e,t,r){if(!e.s){if(r instanceof f){if(!r.s)return void(r.o=c.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(c.bind(null,e,t),c.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var f=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,a=this.s;if(a){var i=1&a?t:r;if(i){try{c(n,1,i(this.v))}catch(e){c(n,2,e)}return n}return this}return this.o=function(e){try{var a=e.v;1&e.s?c(n,1,t?t(a):a):r?c(n,1,r(a)):c(n,2,a)}catch(e){c(n,2,e)}},n},e}();function p(e){return e instanceof f&&1&e.s}function h(e,t,r){for(var n;;){var a=e();if(p(a)&&(a=a.v),!a)return i;if(a.then){n=0;break}var i=r();if(i&&i.then){if(!p(i)){n=1;break}i=i.s}if(t){var o=t();if(o&&o.then&&!p(o)){n=2;break}}}var s=new f,u=c.bind(null,s,2);return(0===n?a.then(h):1===n?i.then(l):o.then(g)).then(void 0,u),s;function l(n){i=n;do{if(t&&(o=t())&&o.then&&!p(o))return void o.then(g).then(void 0,u);if(!(a=e())||p(a)&&!a.v)return void c(s,1,i);if(a.then)return void a.then(h).then(void 0,u);p(i=r())&&(i=i.v)}while(!i||!i.then);i.then(l).then(void 0,u)}function h(e){e?(i=r())&&i.then?i.then(l).then(void 0,u):l(i):c(s,1,i)}function g(){(a=e())?a.then?a.then(h).then(void 0,u):h(a):c(s,1,i)}}function g(e,t){return e&&e.then?e.then(t):t(e)}function v(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var d=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return v((function(){var n,a,i=!1,o=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return g(h((function(){return!i}),void 0,(function(){var s=e.shift();return l((function(){return u(o,(function(e){n=e,i=!0}))}),(function(){if(a)throw new Error(r);e.length||(a=!0),o=t(s)}))})),(function(e){return n}))}))()},b=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},y=function(t){var r,i,o=t.value,u=t.arg,l=(t.key,t.locale);if("string"==typeof o||o&&"object"===e(o)&&"nodeType"in o)return o;if(o&&"object"===e(o)){var c=Object.keys(o)[0];if(["number","date","relative","list"].includes(c)){if(Array.isArray(o[c])){var f=a(o[c],3);o=f[0],r=f[1],i=f[2]}else o=o[c];if("relative"===c)return new Intl.RelativeTimeFormat(l,i).format(o,r);if("list"===c)return o.sort(new Intl.Collator(l,i).compare),new Intl.ListFormat(l,r).format(o)}}var p=function(e){if("string"==typeof u){var t,a=u.indexOf("|");-1===a?u===e&&(r={}):u.slice(0,a)===e&&(t=u.slice(a+1),r=n({},r,{},s.parse("{"+t.replace(/^\{/,"").replace(/\}$/,"")+"}")))}return r};if("number"==typeof o)return new Intl.NumberFormat(l,p("NUMBER")).format(o);if(o&&"object"===e(o)&&"function"==typeof o.getTime)return new Intl.DateTimeFormat(l,p("DATETIME")).format(o);throw new TypeError("Unknown formatter")},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.messageStyle,n=void 0===r?"richNested":r;return"function"==typeof n?n:"richNested"===n?function(t,r){var n=t&&"object"===e(t)&&t.body,a=r.split("."),i=!1,o=n;return a.some((function(t,r,n){return!o||"object"!==e(o)||(r===n.length-1&&t in o&&o[t]&&"object"===e(o[t])&&"message"in o[t]&&"string"==typeof o[t].message&&(i={value:o[t].message,info:o[t]}),o=o[t],!1)})),i}:"rich"===n?function(t,r){var n=t&&"object"===e(t)&&t.body;return!!(n&&"object"===e(n)&&r in n&&n[r]&&"object"===e(n[r])&&"message"in n[r]&&"string"==typeof n[r].message)&&{value:n[r].message,info:n[r]}}:"plain"===n?function(t,r){var n=t&&"object"===e(t)&&t.body;return!!(n&&"object"===e(n)&&r in n&&n[r]&&"string"==typeof n[r])&&{value:n[r]}}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},w=function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.message,a=r.defaults,i=r.messageStyle,o=r.messageForKey,s=void 0===o?m({messageStyle:i}):o,u=r.key;if("string"!=typeof u)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");if("string"==typeof n)t=n;else if(!1===a||null==a)t=!1;else{if(!a||"object"!==e(a))throw new TypeError("Default locale strings must resolve to `false`, nullish, or an object!");(t=s({body:a},u))&&(t=t.value)}if(!1===t)throw new Error("Key value not found for key: (".concat(u,")"));return t},k=function(t){var r=t.string,n=t.dom,i=t.usedKeys,o=t.substitutions,s=t.allSubstitutions,u=t.locale,l=t.missingSuppliedFormatters,c=t.checkExtraSuppliedFormatters,f=/(\\*)\{((?:(?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\\})*?)(?:(\|)((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g;s&&(s=Array.isArray(s)?s:[s]);var p=function(e){var t=e.key,r=e.arg,n=o[t];return"function"==typeof n&&(n=n({arg:r,key:t})),s?n=s.reduce((function(e,n){return n({value:e,arg:r,key:t,locale:u})}),n):r&&r.match(/^(?:NUMBER|DATE)(?:\||$)/)&&(n=y({value:n,arg:r,key:t,locale:u})),n};if(!n){var h=!1,g=r.replace(f,(function(t,r,n,a,o){if(r.length%2)return r.slice(0,-2)+"{"+n+(a||"")+(o||"")+"}";if(l(n))return t;var s=p({key:n,arg:o});return h=h||s&&"object"===e(s)&&"nodeType"in s,i.push(n),r.slice(0,r.length/2)+s}));if(!h)return c(),g;i.length=0}for(var v,d=[],b=0;null!==(v=f.exec(r));){var m=a(v,5),w=m[0],k=m[1],F=m[2],x=m[3],D=m[4],S=f.lastIndex,j=S-k.length-F.length-(x||"").length-(D||"").length-2;if(j>b&&d.push(r.slice(b,j)),k.length%2)d.push(k.slice(0,-2)+"{"+F+(x||"")+(D||"")+"}"),b=S;else{if(l(F))d.push(w);else{k.length&&d.push(k.slice(0,k.length/2));var E=p({key:F,arg:D});d.push(E)}b=S,i.push(F)}}return b!==r.length&&d.push(r.slice(b)),c(),d},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,r=e.locale,n=e.allSubstitutions,a=void 0===n?[y]:n,o=e.insertNodes,s=void 0===o?k:o,u=e.substitutions,l=void 0!==u&&u,c=e.dom,f=void 0!==c&&c,p=e.forceNodeReturn,h=void 0!==p&&p,g=e.throwOnMissingSuppliedFormatters,v=void 0===g||g,d=e.throwOnExtraSuppliedFormatters,b=void 0===d||d;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var m=function(e){return h?document.createTextNode(e):e},w=[],F=function(){b&&Object.keys(l).forEach((function(e){if(!e.startsWith("-")&&!w.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},x=function(e){if(!(e.startsWith("-")||e in l)){if(v)throw new Error("Missing formatting key: ".concat(e));return!0}return!1};if(!l&&!a&&!v)return m(t);l||(l={});var D=s({string:t,dom:f,usedKeys:w,substitutions:l,allSubstitutions:a,locale:r,missingSuppliedFormatters:x,checkExtraSuppliedFormatters:F});if("string"==typeof D)return m(D);var S=document.createDocumentFragment();return S.append.apply(S,i(D)),S},x=v((function(){var e=v((function(t){if("string"!=typeof t)throw new TypeError("Non-string locale type");var r=c(p,t);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return l((function(){return u(fetch(r),(function(e){if(404===e.status)throw new Error("Trying again");return u(e.json(),(function(e){return{locale:t,strings:e}}))}))}),(function(r){if("SyntaxError"===r.name)throw r;return u(g(t),e)}))})),t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.locales,n=void 0===r?navigator.languages:r,a=t.defaultLocales,o=void 0===a?["en-US"]:a,s=t.localeResolver,c=void 0===s?b:s,f=t.localesBasePath,p=void 0===f?".":f,h=t.localeMatcher,g=void 0===h?"lookup":h;if("lookup"===g)g=function(e){if(!e.includes("-"))throw new Error("Locale not available");return e.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,"")};else if("function"!=typeof g)throw new TypeError('`localeMatcher` must be "lookup" or a function!');return d([].concat(i(n),i(o)),e,"No matching locale found!")})),D=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.locales,a=t.defaultLocales,i=t.localesBasePath,o=t.localeResolver,s=t.localeMatcher,l=t.messageStyle,c=t.allSubstitutions,f=t.insertNodes,p=t.defaults,h=t.substitutions,g=t.dom,v=void 0!==g&&g,d=t.forceNodeReturn,b=void 0!==d&&d,y=t.throwOnMissingSuppliedFormatters,k=void 0===y||y,D=t.throwOnExtraSuppliedFormatters,S=void 0===D||D;return u(x({locales:r,defaultLocales:a,localeResolver:o,localesBasePath:i,localeMatcher:s}),(function(t){var r=t.strings,a=t.locale;if(!r||"object"!==e(r))throw new TypeError("Locale strings must be an object!");var i=m({messageStyle:l});return function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o.allSubstitutions,u=void 0===s?c:s,l=o.defaults,g=void 0===l?p:l,d=o.dom,y=void 0===d?v:d,m=o.forceNodeReturn,x=void 0===m?b:m,D=o.throwOnMissingSuppliedFormatters,j=void 0===D?k:D,E=o.throwOnExtraSuppliedFormatters,_=void 0===E?S:E,O=i(r,e),A=w({message:O&&O.value||!1,defaults:g,messageForKey:i,key:e});return F({string:A,locale:a,allSubstitutions:u,insertNodes:f,substitutions:n({},h,{},t),dom:y,forceNodeReturn:x,throwOnMissingSuppliedFormatters:j,throwOnExtraSuppliedFormatters:_})}}))};export{y as defaultAllSubstitutions,k as defaultInsertNodes,b as defaultLocaleResolver,x as findLocaleStrings,F as getDOMForLocaleString,m as getMessageForKeyByStyle,w as getStringFromMessageAndDefaults,D as i18n,d as promiseChainForValues};
//# sourceMappingURL=index.esm.min.js.map
