function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function o(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function i(e,t,r){if(!e.s){if(r instanceof u){if(!r.s)return void(r.o=i.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(i.bind(null,e,t),i.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var u=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var u=1&o?t:r;if(u){try{i(n,1,u(this.v))}catch(e){i(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?i(n,1,t?t(o):o):r?i(n,1,r(o)):i(n,2,o)}catch(e){i(n,2,e)}},n},e}();function a(e){return e instanceof u&&1&e.s}function s(e,t,r){for(var n;;){var o=e();if(a(o)&&(o=o.v),!o)return s;if(o.then){n=0;break}var s=r();if(s&&s.then){if(!a(s)){n=1;break}s=s.s}if(t){var c=t();if(c&&c.then&&!a(c)){n=2;break}}}var f=new u,l=i.bind(null,f,2);return(0===n?o.then(v):1===n?s.then(h):c.then(d)).then(void 0,l),f;function h(n){s=n;do{if(t&&(c=t())&&c.then&&!a(c))return void c.then(d).then(void 0,l);if(!(o=e())||a(o)&&!o.v)return void i(f,1,s);if(o.then)return void o.then(v).then(void 0,l);a(s=r())&&(s=s.v)}while(!s||!s.then);s.then(h).then(void 0,l)}function v(e){e?(s=r())&&s.then?s.then(h).then(void 0,l):h(s):i(f,1,s)}function d(){(o=e())?o.then?o.then(v).then(void 0,l):v(o):i(f,1,s)}}function c(e,t){return e&&e.then?e.then(t):t(e)}function f(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return f((function(){var i,u,a=!1,f=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return c(s((function(){return!a}),void 0,(function(){var s=e.shift();return o((function(){return n(f,(function(e){i=e,a=!0}))}),(function(){if(u)throw new Error(r);e.length||(u=!0),f=t(s)}))})),(function(e){return i}))}))()},h=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.messageStyle,n=void 0===r?"rich":r;return"function"==typeof n?n:"rich"===n?function(t,r){return!!(t&&"object"===e(t)&&r in t&&t[r]&&"object"===e(t[r])&&"message"in t[r]&&"string"==typeof t[r].message)&&t[r].message}:"plain"===n?function(t,r){return!!(t&&"object"===e(t)&&r in t&&t[r]&&"string"==typeof t[r])&&t[r]}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.message,n=t.defaults,o=t.messageStyle,i=t.messageForKey,u=void 0===i?v({messageStyle:o}):i,a=t.key;if("string"!=typeof a)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");var s="string"==typeof r?r:!1!==n&&(n&&"object"===e(n)?u(n,a):function(){throw new TypeError("Default locale strings must resolve to `false` or an object!")}());if(!1===s)throw new Error("Key value not found for key: (".concat(a,")"));return s},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.string,n=e.substitutions,o=void 0!==n&&n,i=e.dom,u=void 0!==i&&i,a=e.forceNodeReturn,s=void 0!==a&&a,c=e.throwOnMissingSuppliedFormatters,f=void 0===c||c,l=e.throwOnExtraSuppliedFormatters,h=void 0===l||l,v=e.bracketRegex,d=void 0===v?/(\\*)\{((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)(?:\|((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g:v;if("string"!=typeof r)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var p=function(e){return s?document.createTextNode(e):e},y=[],g=function(){h&&Object.keys(o).forEach((function(e){if(!y.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},F=function(e){if(f&&!(e in o))throw new Error("Missing formatting key: ".concat(e))};if(!o&&!f)return p(r);if(o||(o={}),!u){var m=!1,w=r.replace(d,(function(e,t,r,n){if(t.length%2)return e;F(r);var i=o[r];return"function"==typeof i&&(i=i(n)),m=m||i&&1===i.nodeType,y.push(r),t+i}));if(g(),!m)return p(w);y.length=0}for(var b,D=[],E=0;null!==(b=d.exec(r));){var S=b,j=t(S,4),x=j[1],T=j[2],k=j[3],B=d.lastIndex;if(!(x%2)){var R=B-T.length-2;R>E&&D.push(r.slice(E,R)),x.length&&D.push(x),F(T);var A=o[T];"function"==typeof A&&(A=A(k)),D.push(A),E=B,y.push(T)}}E!==r.length&&D.push(r.slice(E)),g();var O=document.createDocumentFragment();return O.append.apply(O,D),O},y=f((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,i=void 0===t?navigator.languages:t,u=e.defaultLocales,a=void 0===u?["en-US"]:u,s=e.localeResolver,c=void 0===s?h:s,f=e.localesBasePath,v=void 0===f?".":f;return l([].concat(r(i),r(a)),(function e(t){try{if("string"!=typeof t)throw new TypeError("Non-string locale type");var r=c(v,t);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return o((function(){return n(fetch(r),(function(e){if(404===e.status)throw new Error("Trying again");return n(e.json())}))}),(function(r){if("SyntaxError"===r.name)throw r;if(!t.includes("-"))throw new Error("Locale not available");return e(t.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,""))}))}catch(e){return Promise.reject(e)}}),"No matching locale found!")})),g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.locales,o=t.defaultLocales,i=t.localesBasePath,u=t.localeResolver,a=t.messageStyle,s=t.bracketRegex,c=t.defaults,f=t.dom,l=void 0!==f&&f,h=t.forceNodeReturn,g=void 0!==h&&h,F=t.throwOnMissingSuppliedFormatters,m=void 0===F||F,w=t.throwOnExtraSuppliedFormatters,b=void 0===w||w;return n(y({locales:r,defaultLocales:o,localeResolver:u,localesBasePath:i}),(function(t){if(!t||"object"!==e(t))throw new TypeError("Locale strings must be an object!");var r=v({messageStyle:a});return function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.defaults,u=void 0===i?c:i,a=o.dom,f=void 0===a?l:a,h=o.forceNodeReturn,v=void 0===h?g:h,y=o.throwOnMissingSuppliedFormatters,F=void 0===y?m:y,w=o.throwOnExtraSuppliedFormatters,D=void 0===w?b:w,E=r(t,e),S=d({message:E,defaults:u,messageForKey:r,key:e});return p({string:S,substitutions:n,dom:f,forceNodeReturn:v,throwOnMissingSuppliedFormatters:F,throwOnExtraSuppliedFormatters:D,bracketRegex:s})}}))};export{h as defaultLocaleResolver,y as findLocaleStrings,p as getDOMForLocaleString,v as getMessageForKeyByStyle,d as getStringFromMessageAndDefaults,g as i18n,l as promiseChainForValues};
//# sourceMappingURL=index.esm.min.js.map
