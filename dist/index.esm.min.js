function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(o,!0).forEach((function(r){t(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(o).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function a(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function c(e,t,r){if(!e.s){if(r instanceof s){if(!r.s)return void(r.o=c.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(c.bind(null,e,t),c.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var s=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{c(n,1,i(this.v))}catch(e){c(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?c(n,1,t?t(o):o):r?c(n,1,r(o)):c(n,2,o)}catch(e){c(n,2,e)}},n},e}();function f(e){return e instanceof s&&1&e.s}function l(e,t,r){for(var n;;){var o=e();if(f(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!f(i)){n=1;break}i=i.s}if(t){var u=t();if(u&&u.then&&!f(u)){n=2;break}}}var a=new s,l=c.bind(null,a,2);return(0===n?o.then(v):1===n?i.then(h):u.then(p)).then(void 0,l),a;function h(n){i=n;do{if(t&&(u=t())&&u.then&&!f(u))return void u.then(p).then(void 0,l);if(!(o=e())||f(o)&&!o.v)return void c(a,1,i);if(o.then)return void o.then(v).then(void 0,l);f(i=r())&&(i=i.v)}while(!i||!i.then);i.then(h).then(void 0,l)}function v(e){e?(i=r())&&i.then?i.then(h).then(void 0,l):h(i):c(a,1,i)}function p(){(o=e())?o.then?o.then(v).then(void 0,l):v(o):c(a,1,i)}}function h(e,t){return e&&e.then?e.then(t):t(e)}function v(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var p=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return v((function(){var n,o,i=!1,c=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return h(l((function(){return!i}),void 0,(function(){var s=e.shift();return a((function(){return u(c,(function(e){n=e,i=!0}))}),(function(){if(o)throw new Error(r);e.length||(o=!0),c=t(s)}))})),(function(e){return n}))}))()},y=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.messageStyle,n=void 0===r?"rich":r;return"function"==typeof n?n:"rich"===n?function(t,r){return!!(t&&"object"===e(t)&&r in t&&t[r]&&"object"===e(t[r])&&"message"in t[r]&&"string"==typeof t[r].message)&&t[r].message}:"plain"===n?function(t,r){return!!(t&&"object"===e(t)&&r in t&&t[r]&&"string"==typeof t[r])&&t[r]}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.message,n=t.defaults,o=t.messageStyle,i=t.messageForKey,u=void 0===i?d({messageStyle:o}):i,a=t.key;if("string"!=typeof a)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");var c="string"==typeof r?r:!1!==n&&(n&&"object"===e(n)?u(n,a):function(){throw new TypeError("Default locale strings must resolve to `false` or an object!")}());if(!1===c)throw new Error("Key value not found for key: (".concat(a,")"));return c},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,r=e.substitutions,n=void 0!==r&&r,i=e.dom,u=void 0!==i&&i,a=e.forceNodeReturn,c=void 0!==a&&a,s=e.throwOnMissingSuppliedFormatters,f=void 0===s||s,l=e.throwOnExtraSuppliedFormatters,h=void 0===l||l,v=e.bracketRegex,p=void 0===v?/(\\*)\{((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)(?:\|((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g:v;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var y=function(e){return c?document.createTextNode(e):e},d=[],g=function(){h&&Object.keys(n).forEach((function(e){if(!d.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},F=function(e){if(!(e in n)){if(f)throw new Error("Missing formatting key: ".concat(e));return!0}return!1};if(!n&&!f)return y(t);if(n||(n={}),!u){var m=!1,b=t.replace(p,(function(e,t,r,o){if(t.length%2)return e;if(F(r))return e;var i=n[r];return"function"==typeof i&&(i=i(o)),m=m||i&&1===i.nodeType,d.push(r),t+i}));if(g(),!m)return y(b);d.length=0}for(var w,D=[],E=0;null!==(w=p.exec(t));){var j=w,O=o(j,4),S=O[0],x=O[1],P=O[2],T=O[3],k=p.lastIndex;if(!(x%2)){var B=k-P.length-2;if(B>E&&D.push(t.slice(E,B)),F(P))D.push(S);else{x.length&&D.push(x);var R=n[P];"function"==typeof R&&(R=R(T)),D.push(R)}E=k,d.push(P)}}E!==t.length&&D.push(t.slice(E)),g();var A=document.createDocumentFragment();return A.append.apply(A,D),A},m=v((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,r=void 0===t?navigator.languages:t,n=e.defaultLocales,o=void 0===n?["en-US"]:n,c=e.localeResolver,s=void 0===c?y:c,f=e.localesBasePath,l=void 0===f?".":f;return p([].concat(i(r),i(o)),(function e(t){try{if("string"!=typeof t)throw new TypeError("Non-string locale type");var r=s(l,t);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return a((function(){return u(fetch(r),(function(e){if(404===e.status)throw new Error("Trying again");return u(e.json())}))}),(function(r){if("SyntaxError"===r.name)throw r;if(!t.includes("-"))throw new Error("Locale not available");return e(t.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,""))}))}catch(e){return Promise.reject(e)}}),"No matching locale found!")})),b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.locales,o=t.defaultLocales,i=t.localesBasePath,a=t.localeResolver,c=t.messageStyle,s=t.bracketRegex,f=t.substitutions,l=t.defaults,h=t.dom,v=void 0!==h&&h,p=t.forceNodeReturn,y=void 0!==p&&p,b=t.throwOnMissingSuppliedFormatters,w=void 0===b||b,D=t.throwOnExtraSuppliedFormatters,E=void 0===D||D;return u(m({locales:r,defaultLocales:o,localeResolver:a,localesBasePath:i}),(function(t){if(!t||"object"!==e(t))throw new TypeError("Locale strings must be an object!");var r=d({messageStyle:c});return function(e,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=i.defaults,a=void 0===u?l:u,c=i.dom,h=void 0===c?v:c,p=i.forceNodeReturn,d=void 0===p?y:p,m=i.throwOnMissingSuppliedFormatters,b=void 0===m?w:m,D=i.throwOnExtraSuppliedFormatters,j=void 0===D?E:D,O=r(t,e),S=g({message:O,defaults:a,messageForKey:r,key:e});return F({string:S,substitutions:n({},f,{},o),dom:h,forceNodeReturn:d,throwOnMissingSuppliedFormatters:b,throwOnExtraSuppliedFormatters:j,bracketRegex:s})}}))};export{y as defaultLocaleResolver,m as findLocaleStrings,F as getDOMForLocaleString,d as getMessageForKeyByStyle,g as getStringFromMessageAndDefaults,b as i18n,p as promiseChainForValues};
//# sourceMappingURL=index.esm.min.js.map
