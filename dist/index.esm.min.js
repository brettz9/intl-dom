function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(o,!0).forEach((function(r){e(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(o).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e,r){return r?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}function a(t,e){try{var r=t()}catch(t){return e(t)}return r&&r.then?r.then(void 0,e):r}function s(t,e,r){if(!t.s){if(r instanceof c){if(!r.s)return void(r.o=s.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(s.bind(null,t,e),s.bind(null,t,2));t.s=e,t.v=r;var n=t.o;n&&n(t)}}var c=function(){function t(){}return t.prototype.then=function(e,r){var n=new t,o=this.s;if(o){var i=1&o?e:r;if(i){try{s(n,1,i(this.v))}catch(t){s(n,2,t)}return n}return this}return this.o=function(t){try{var o=t.v;1&t.s?s(n,1,e?e(o):o):r?s(n,1,r(o)):s(n,2,o)}catch(t){s(n,2,t)}},n},t}();function f(t){return t instanceof c&&1&t.s}function l(t,e,r){for(var n;;){var o=t();if(f(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!f(i)){n=1;break}i=i.s}if(e){var u=e();if(u&&u.then&&!f(u)){n=2;break}}}var a=new c,l=s.bind(null,a,2);return(0===n?o.then(v):1===n?i.then(h):u.then(p)).then(void 0,l),a;function h(n){i=n;do{if(e&&(u=e())&&u.then&&!f(u))return void u.then(p).then(void 0,l);if(!(o=t())||f(o)&&!o.v)return void s(a,1,i);if(o.then)return void o.then(v).then(void 0,l);f(i=r())&&(i=i.v)}while(!i||!i.then);i.then(h).then(void 0,l)}function v(t){t?(i=r())&&i.then?i.then(h).then(void 0,l):h(i):s(a,1,i)}function p(){(o=t())?o.then?o.then(v).then(void 0,l):v(o):s(a,1,i)}}function h(t,e){return t&&t.then?t.then(e):e(t)}function v(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return Promise.resolve(t.apply(this,e))}catch(t){return Promise.reject(t)}}}var p=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(t))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof e)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return v((function(){var n,o,i=!1,s=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return h(l((function(){return!i}),void 0,(function(){var c=t.shift();return a((function(){return u(s,(function(t){n=t,i=!0}))}),(function(){if(o)throw new Error(r);t.length||(o=!0),s=e(c)}))})),(function(t){return n}))}))()},y=function(t,e){if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(t.replace(/\/$/,""),"/_locales/").concat(e,"/messages.json")},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.messageStyle,n=void 0===r?"rich":r;return"function"==typeof n?n:"rich"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"object"===t(e[r])&&"message"in e[r]&&"string"==typeof e[r].message)&&e[r].message}:"plain"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"string"==typeof e[r])&&e[r]}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.message,n=e.defaults,o=e.messageStyle,i=e.messageForKey,u=void 0===i?d({messageStyle:o}):i,a=e.key;if("string"!=typeof a)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");var s="string"==typeof r?r:!1!==n&&null!=n&&(n&&"object"===t(n)?u(n,a):function(){throw new TypeError("Default locale strings must resolve to `false`, nullish, or an object!")}());if(!1===s)throw new Error("Key value not found for key: (".concat(a,")"));return s},F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.string,r=t.allSubstitutions,n=void 0===r?null:r,i=t.substitutions,u=void 0!==i&&i,a=t.dom,s=void 0!==a&&a,c=t.forceNodeReturn,f=void 0!==c&&c,l=t.throwOnMissingSuppliedFormatters,h=void 0===l||l,v=t.throwOnExtraSuppliedFormatters,p=void 0===v||v,y=t.formattingRegex,d=void 0===y?/(\\*)\{((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)(?:\|((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g:y;if("string"!=typeof e)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var g=function(t){return f?document.createTextNode(t):t},F=[],m=function(){p&&Object.keys(u).forEach((function(t){if(!F.includes(t))throw new Error("Extra formatting key: ".concat(t))}))},b=function(t){if(!(t in u)){if(h)throw new Error("Missing formatting key: ".concat(t));return!0}return!1};if(!u&&!n&&!h)return g(e);if(u||(u={}),!s){var w=!1,D=e.replace(d,(function(t,e,r,o){if(e.length%2)return t;if(b(r))return t;var i=u[r];return"function"==typeof i&&(i=i({arg:o,key:r})),n&&(i=n({value:i,arg:o,key:r})),w=w||i&&1===i.nodeType,F.push(r),e+i}));if(m(),!w)return g(D);F.length=0}for(var S,E=[],j=0;null!==(S=d.exec(e));){var O=S,x=o(O,4),P=x[0],T=x[1],k=x[2],B=x[3],R=d.lastIndex;if(!(T%2)){var A=R-k.length-2;if(A>j&&E.push(e.slice(j,A)),b(k))E.push(P);else{T.length&&E.push(T);var C=u[k];"function"==typeof C&&(C=C(B,k)),E.push(C)}j=R,F.push(k)}}j!==e.length&&E.push(e.slice(j)),m();var L=document.createDocumentFragment();return L.append.apply(L,E),L},m=v((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.locales,r=void 0===e?navigator.languages:e,n=t.defaultLocales,o=void 0===n?["en-US"]:n,s=t.localeResolver,c=void 0===s?y:s,f=t.localesBasePath,l=void 0===f?".":f;return p([].concat(i(r),i(o)),(function t(e){try{if("string"!=typeof e)throw new TypeError("Non-string locale type");var r=c(l,e);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return a((function(){return u(fetch(r),(function(t){if(404===t.status)throw new Error("Trying again");return u(t.json())}))}),(function(r){if("SyntaxError"===r.name)throw r;if(!e.includes("-"))throw new Error("Locale not available");return t(e.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,""))}))}catch(t){return Promise.reject(t)}}),"No matching locale found!")})),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.locales,o=e.defaultLocales,i=e.localesBasePath,a=e.localeResolver,s=e.messageStyle,c=e.formattingRegex,f=e.allSubstitutions,l=e.defaults,h=e.substitutions,v=e.dom,p=void 0!==v&&v,y=e.forceNodeReturn,b=void 0!==y&&y,w=e.throwOnMissingSuppliedFormatters,D=void 0===w||w,S=e.throwOnExtraSuppliedFormatters,E=void 0===S||S;return u(m({locales:r,defaultLocales:o,localeResolver:a,localesBasePath:i}),(function(e){if(!e||"object"!==t(e))throw new TypeError("Locale strings must be an object!");var r=d({messageStyle:s});return function(t,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=i.allSubstitutions,a=void 0===u?f:u,s=i.defaults,v=void 0===s?l:s,y=i.dom,d=void 0===y?p:y,m=i.forceNodeReturn,w=void 0===m?b:m,S=i.throwOnMissingSuppliedFormatters,j=void 0===S?D:S,O=i.throwOnExtraSuppliedFormatters,x=void 0===O?E:O,P=r(e,t),T=g({message:P,defaults:v,messageForKey:r,key:t});return F({string:T,formattingRegex:c,allSubstitutions:a,substitutions:n({},h,{},o),dom:d,forceNodeReturn:w,throwOnMissingSuppliedFormatters:j,throwOnExtraSuppliedFormatters:x})}}))};export{y as defaultLocaleResolver,m as findLocaleStrings,F as getDOMForLocaleString,d as getMessageForKeyByStyle,g as getStringFromMessageAndDefaults,b as i18n,p as promiseChainForValues};
//# sourceMappingURL=index.esm.min.js.map
