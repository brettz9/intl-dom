!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).IntlDom={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function i(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function u(e,t,r){if(!e.s){if(r instanceof a){if(!r.s)return void(r.o=u.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(u.bind(null,e,t),u.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var a=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{u(n,1,i(this.v))}catch(e){u(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?u(n,1,t?t(o):o):r?u(n,1,r(o)):u(n,2,o)}catch(e){u(n,2,e)}},n},e}();function s(e){return e instanceof a&&1&e.s}function c(e,t,r){for(var n;;){var o=e();if(s(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!s(i)){n=1;break}i=i.s}if(t){var c=t();if(c&&c.then&&!s(c)){n=2;break}}}var f=new a,l=u.bind(null,f,2);return(0===n?o.then(d):1===n?i.then(h):c.then(v)).then(void 0,l),f;function h(n){i=n;do{if(t&&(c=t())&&c.then&&!s(c))return void c.then(v).then(void 0,l);if(!(o=e())||s(o)&&!o.v)return void u(f,1,i);if(o.then)return void o.then(d).then(void 0,l);s(i=r())&&(i=i.v)}while(!i||!i.then);i.then(h).then(void 0,l)}function d(e){e?(i=r())&&i.then?i.then(h).then(void 0,l):h(i):u(f,1,i)}function v(){(o=e())?o.then?o.then(d).then(void 0,l):d(o):u(f,1,i)}}function f(e,t){return e&&e.then?e.then(t):t(e)}function l(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var h=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return l((function(){var n,u,a=!1,s=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return f(c((function(){return!a}),void 0,(function(){var c=e.shift();return i((function(){return o(s,(function(e){n=e,a=!0}))}),(function(){if(u)throw new Error(r);e.length||(u=!0),s=t(c)}))})),(function(e){return n}))}))()},d=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.messageStyle,n=void 0===r?"rich":r;return"function"==typeof n?n:"rich"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"message"in e[r]&&"string"==typeof e[r].message)&&e[r].message}:"plain"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"string"==typeof e[r])&&e[r]}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.message,n=e.defaults,o=e.messageStyle,i=e.messageForKey,u=void 0===i?v({messageStyle:o}):i,a=e.key;if("string"!=typeof a)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");var s="string"==typeof r?r:!1!==n&&(n&&"object"===t(n)?u(n,a):function(){throw new TypeError("Default locale strings must resolve to `false` or an object!")}());if(!1===s)throw new Error("Key value not found for key: (".concat(a,")"));return s},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,n=e.substitutions,o=void 0!==n&&n,i=e.dom,u=void 0!==i&&i,a=e.forceNodeReturn,s=void 0!==a&&a,c=e.throwOnMissingSuppliedFormatters,f=void 0===c||c,l=e.throwOnExtraSuppliedFormatters,h=void 0===l||l,d=e.bracketRegex,v=void 0===d?/(\\*)\{((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)(?:\|((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g:d;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var p=function(e){return s?document.createTextNode(e):e},y=[],g=function(){h&&Object.keys(o).forEach((function(e){if(!y.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},F=function(e){if(f&&!(e in o))throw new Error("Missing formatting key: ".concat(e))};if(!o&&!f)return p(t);if(o||(o={}),!u){var m=!1,w=t.replace(v,(function(e,t,r,n){if(t.length%2)return e;F(r);var i=o[r];return"function"==typeof i&&(i=i(n)),m=m||i&&1===i.nodeType,y.push(r),t+i}));if(g(),!m)return p(w);y.length=0}for(var b,D=[],S=0;null!==(b=v.exec(t));){var E=b,j=r(E,4),x=j[1],T=j[2],k=j[3],B=v.lastIndex;if(!(x%2)){var O=B-T.length-2;O>S&&D.push(t.slice(S,O)),x.length&&D.push(x),F(T);var R=o[T];"function"==typeof R&&(R=R(k)),D.push(R),S=B,y.push(T)}}S!==t.length&&D.push(t.slice(S)),g();var A=document.createDocumentFragment();return A.append.apply(A,D),A},g=l((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,r=void 0===t?navigator.languages:t,u=e.defaultLocales,a=void 0===u?["en-US"]:u,s=e.localeResolver,c=void 0===s?d:s,f=e.localesBasePath,l=void 0===f?".":f;return h([].concat(n(r),n(a)),(function e(t){try{if("string"!=typeof t)throw new TypeError("Non-string locale type");var r=c(l,t);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return i((function(){return o(fetch(r),(function(e){if(404===e.status)throw new Error("Trying again");return o(e.json())}))}),(function(r){if("SyntaxError"===r.name)throw r;if(!t.includes("-"))throw new Error("Locale not available");return e(t.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,""))}))}catch(e){return Promise.reject(e)}}),"No matching locale found!")}));e.defaultLocaleResolver=d,e.findLocaleStrings=g,e.getDOMForLocaleString=y,e.getMessageForKeyByStyle=v,e.getStringFromMessageAndDefaults=p,e.i18n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.locales,n=e.defaultLocales,i=e.localesBasePath,u=e.localeResolver,a=e.messageStyle,s=e.bracketRegex,c=e.defaults,f=e.dom,l=void 0!==f&&f,h=e.forceNodeReturn,d=void 0!==h&&h,F=e.throwOnMissingSuppliedFormatters,m=void 0===F||F,w=e.throwOnExtraSuppliedFormatters,b=void 0===w||w;return o(g({locales:r,defaultLocales:n,localeResolver:u,localesBasePath:i}),(function(e){if(!e||"object"!==t(e))throw new TypeError("Locale strings must be an object!");var r=v({messageStyle:a});return function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.defaults,u=void 0===i?c:i,a=o.dom,f=void 0===a?l:a,h=o.forceNodeReturn,v=void 0===h?d:h,g=o.throwOnMissingSuppliedFormatters,F=void 0===g?m:g,w=o.throwOnExtraSuppliedFormatters,D=void 0===w?b:w,S=r(e,t),E=p({message:S,defaults:u,messageForKey:r,key:t});return y({string:E,substitutions:n,dom:f,forceNodeReturn:v,throwOnMissingSuppliedFormatters:F,throwOnExtraSuppliedFormatters:D,bracketRegex:s})}}))},e.promiseChainForValues=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
