!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).IntlDom={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(o,!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(o).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function s(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}function c(e,t,r){if(!e.s){if(r instanceof f){if(!r.s)return void(r.o=c.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(c.bind(null,e,t),c.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}var f=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,o=this.s;if(o){var i=1&o?t:r;if(i){try{c(n,1,i(this.v))}catch(e){c(n,2,e)}return n}return this}return this.o=function(e){try{var o=e.v;1&e.s?c(n,1,t?t(o):o):r?c(n,1,r(o)):c(n,2,o)}catch(e){c(n,2,e)}},n},e}();function l(e){return e instanceof f&&1&e.s}function h(e,t,r){for(var n;;){var o=e();if(l(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=r();if(i&&i.then){if(!l(i)){n=1;break}i=i.s}if(t){var u=t();if(u&&u.then&&!l(u)){n=2;break}}}var a=new f,s=c.bind(null,a,2);return(0===n?o.then(v):1===n?i.then(h):u.then(p)).then(void 0,s),a;function h(n){i=n;do{if(t&&(u=t())&&u.then&&!l(u))return void u.then(p).then(void 0,s);if(!(o=e())||l(o)&&!o.v)return void c(a,1,i);if(o.then)return void o.then(v).then(void 0,s);l(i=r())&&(i=i.v)}while(!i||!i.then);i.then(h).then(void 0,s)}function v(e){e?(i=r())&&i.then?i.then(h).then(void 0,s):h(i):c(a,1,i)}function p(){(o=e())?o.then?o.then(v).then(void 0,s):v(o):c(a,1,i)}}function v(e,t){return e&&e.then?e.then(t):t(e)}function p(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var d=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return p((function(){var n,o,i=!1,u=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return v(h((function(){return!i}),void 0,(function(){var c=e.shift();return s((function(){return a(u,(function(e){n=e,i=!0}))}),(function(){if(o)throw new Error(r);e.length||(o=!0),u=t(c)}))})),(function(e){return n}))}))()},y=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.messageStyle,n=void 0===r?"rich":r;return"function"==typeof n?n:"rich"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"object"===t(e[r])&&"message"in e[r]&&"string"==typeof e[r].message)&&e[r].message}:"plain"===n?function(e,r){return!!(e&&"object"===t(e)&&r in e&&e[r]&&"string"==typeof e[r])&&e[r]}:function(){throw new TypeError("Unknown `messageStyle` ".concat(n))}()},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.message,n=e.defaults,o=e.messageStyle,i=e.messageForKey,u=void 0===i?g({messageStyle:o}):i,a=e.key;if("string"!=typeof a)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");var s="string"==typeof r?r:!1!==n&&null!=n&&(n&&"object"===t(n)?u(n,a):function(){throw new TypeError("Default locale strings must resolve to `false`, nullish, or an object!")}());if(!1===s)throw new Error("Key value not found for key: (".concat(a,")"));return s},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,r=e.allSubstitutions,n=void 0===r?null:r,o=e.substitutions,u=void 0!==o&&o,a=e.dom,s=void 0!==a&&a,c=e.forceNodeReturn,f=void 0!==c&&c,l=e.throwOnMissingSuppliedFormatters,h=void 0===l||l,v=e.throwOnExtraSuppliedFormatters,p=void 0===v||v,d=e.formattingRegex,y=void 0===d?/(\\*)\{((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)(?:\|((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g:d;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var g=function(e){return f?document.createTextNode(e):e},F=[],m=function(){p&&Object.keys(u).forEach((function(e){if(!F.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},b=function(e){if(!(e in u)){if(h)throw new Error("Missing formatting key: ".concat(e));return!0}return!1};if(!u&&!n&&!h)return g(t);if(u||(u={}),!s){var w=!1,D=t.replace(y,(function(e,t,r,o){if(t.length%2)return e;if(b(r))return e;var i=u[r];return"function"==typeof i&&(i=i({arg:o,key:r})),n&&(i=n({value:i,arg:o,key:r})),w=w||i&&1===i.nodeType,F.push(r),t+i}));if(m(),!w)return g(D);F.length=0}for(var S,j=[],E=0;null!==(S=y.exec(t));){var O=S,x=i(O,4),P=x[0],T=x[1],k=x[2],B=x[3],R=y.lastIndex;if(!(T%2)){var A=R-k.length-2;if(A>E&&j.push(t.slice(E,A)),b(k))j.push(P);else{T.length&&j.push(T);var C=u[k];"function"==typeof C&&(C=C(B,k)),j.push(C)}E=R,F.push(k)}}E!==t.length&&j.push(t.slice(E)),m();var L=document.createDocumentFragment();return L.append.apply(L,j),L},b=p((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,r=void 0===t?navigator.languages:t,n=e.defaultLocales,o=void 0===n?["en-US"]:n,i=e.localeResolver,c=void 0===i?y:i,f=e.localesBasePath,l=void 0===f?".":f;return d([].concat(u(r),u(o)),(function e(t){try{if("string"!=typeof t)throw new TypeError("Non-string locale type");var r=c(l,t);if("string"!=typeof r)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return s((function(){return a(fetch(r),(function(e){if(404===e.status)throw new Error("Trying again");return a(e.json())}))}),(function(r){if("SyntaxError"===r.name)throw r;if(!t.includes("-"))throw new Error("Locale not available");return e(t.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,""))}))}catch(e){return Promise.reject(e)}}),"No matching locale found!")}));e.defaultLocaleResolver=y,e.findLocaleStrings=b,e.getDOMForLocaleString=m,e.getMessageForKeyByStyle=g,e.getStringFromMessageAndDefaults=F,e.i18n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.locales,n=e.defaultLocales,i=e.localesBasePath,u=e.localeResolver,s=e.messageStyle,c=e.formattingRegex,f=e.allSubstitutions,l=e.defaults,h=e.substitutions,v=e.dom,p=void 0!==v&&v,d=e.forceNodeReturn,y=void 0!==d&&d,w=e.throwOnMissingSuppliedFormatters,D=void 0===w||w,S=e.throwOnExtraSuppliedFormatters,j=void 0===S||S;return a(b({locales:r,defaultLocales:n,localeResolver:u,localesBasePath:i}),(function(e){if(!e||"object"!==t(e))throw new TypeError("Locale strings must be an object!");var r=g({messageStyle:s});return function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=i.allSubstitutions,a=void 0===u?f:u,s=i.defaults,v=void 0===s?l:s,d=i.dom,g=void 0===d?p:d,b=i.forceNodeReturn,w=void 0===b?y:b,S=i.throwOnMissingSuppliedFormatters,E=void 0===S?D:S,O=i.throwOnExtraSuppliedFormatters,x=void 0===O?j:O,P=r(e,t),T=F({message:P,defaults:v,messageForKey:r,key:t});return m({string:T,formattingRegex:c,allSubstitutions:a,substitutions:o({},h,{},n),dom:g,forceNodeReturn:w,throwOnMissingSuppliedFormatters:E,throwOnExtraSuppliedFormatters:x})}}))},e.promiseChainForValues=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
