!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).IntlDom={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(a,!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){const n=-1,r=0,a=1,i=2,o=3,s=4,u=5,l=6,c=7,f=8,p=9,h=10,g=11,v=13,d=0,b=[];function y(){var e=b.pop();return e||(e={context:d,elements:null,element_array:null}),e}function m(e){b.push(e)}const w=[];function k(e){w.push(e)}var F=t;F.escape=function(e){var t,n="";if(!e)return e;for(t=0;t<e.length;t++)'"'!=e[t]&&"\\"!=e[t]&&"`"!=e[t]&&"'"!=e[t]||(n+="\\"),n+=e[t];return n},F.begin=function(e,t){const b={name:null,value_type:r,string:"",contains:null},F={line:1,col:1};let x,S=0;var D=0,j=!0,E=!1,_=null,O=void 0,A=[],P={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t},pop(){var e=this.last;return e?((this.last=e.prior)||(this.first=null),e.next=this.saved,this.saved=e,e.node):null}},T=d,N=0,C=!1,B=!1,M=!1,I=!1,R=!1,L={first:null,last:null,saved:null,push(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=null,t.prior=this.last):t={node:e,next:null,prior:this.last},this.last||(this.first=t),this.last=t},shift(){var e=this.first;return e?((this.first=e.next)||(this.last=null),e.next=this.saved,this.saved=e,e.node):null},unshift(e){var t=this.saved;t?(this.saved=t.next,t.node=e,t.next=this.first,t.prior=null):t={node:e,next:this.first,prior:null},this.first||(this.last=t),this.first=t}},$=null,U=!1,q=!1,K=!1,V=!1,z=!1,W=!1,J=!1,G=0,H=0,Q=!1,X=!1;return{value(){var e=_;return _=void 0,e},reset(){D=0,j=!0,L.last&&(L.last.next=L.save),L.save=L.first,L.first=L.last=null,P.last&&(P.last.next=P.save),P.save=L.first,P.first=P.last=null,A=null,O=void 0,T=d,b.value_type=r,b.name=null,b.string="",F.line=1,F.col=1,E=!1,N=0,X=!1,U=!1,K=!1,V=!1},write(n){var r;for("string"!=typeof n&&(n=String(n)),r=this._write(n,!1);r>0&&(_&&("function"==typeof t&&function e(n,r){var a,i,o=n[r];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(void 0!==(i=e(o,a))?o[a]=i:delete o[a]);return t.call(n,r,o)}({"":_},""),e(_),_=void 0),!(r<2));r=this._write());},_write(e,t){var Y,Z,ee,te=0;function ne(e,t){throw new Error(`${e} '${String.fromCodePoint(t)}' unexpected at ${S} (near '${ee.substr(S>4?S-4:0,S>4?3:S-1)}[${String.fromCodePoint(t)}]${ee.substr(S,10)}') [${F.line}:${F.col}]`)}function re(){b.value_type=r,b.string=""}function ae(e){return e.length>1&&!C&&!B&&!M&&48===e.charCodeAt(0)?(E?-1:1)*Number("0o"+e):(E?-1:1)*Number(e)}function ie(){switch(b.value_type){case u:A.push(ae(b.string));break;case s:A.push(b.string);break;case i:A.push(!0);break;case o:A.push(!1);break;case f:case p:A.push(NaN);break;case h:A.push(-1/0);break;case g:A.push(1/0);break;case a:A.push(null);break;case n:A.push(void 0);break;case v:A.push(void 0),delete A[A.length-1];break;case l:case c:A.push(b.contains);break;default:console.log("Unhandled array push.")}}function oe(){switch(b.value_type){case u:O[b.name]=ae(b.string);break;case s:O[b.name]=b.string;break;case i:O[b.name]=!0;break;case o:O[b.name]=!1;break;case f:case p:O[b.name]=NaN;break;case h:O[b.name]=-1/0;break;case g:O[b.name]=1/0;break;case a:O[b.name]=null;break;case n:O[b.name]=void 0;break;case l:case c:O[b.name]=b.contains}}function se(e){let t=0;for(;0==t&&S<ee.length;){x=ee.charAt(S);let n=ee.codePointAt(S++);if(n>=65536&&(x+=ee.charAt(S),S++),F.col++,n==e)K?(b.string+=x,K=!1):(t=-1,Q?ne("Incomplete Octal sequence",n):J?ne("Incomplete hexidecimal sequence",n):W?ne("Incomplete unicode sequence",n):z&&ne("Incomplete long unicode sequence",n),t=1);else if(K){if(Q){if(H<3&&n>=48&&n<=57){if(G*=8,G+=n-48,3===++H){b.string+=String.fromCodePoint(G),Q=!1,K=!1;continue}continue}if(G>255){ne("(escaped character, parsing octal escape val=%d) fault while parsing",n),t=-1;break}b.string+=String.fromCodePoint(G),Q=!1,K=!1;continue}if(z){if(125==n){b.string+=String.fromCodePoint(G),z=!1,W=!1,K=!1;continue}if(G*=16,n>=48&&n<=57)G+=n-48;else if(n>=65&&n<=70)G+=n-65+10;else{if(!(n>=97&&n<=102)){ne("(escaped character, parsing hex of \\u)",n),t=-1,z=!1,K=!1;continue}G+=n-97+10}continue}if(J||W){if(0===H&&123===n){z=!0;continue}if(H<2||W&&H<4){if(G*=16,n>=48&&n<=57)G+=n-48;else if(n>=65&&n<=70)G+=n-65+10;else{if(!(n>=97&&n<=102)){ne(W?"(escaped character, parsing hex of \\u)":"(escaped character, parsing hex of \\x)",n),t=-1,J=!1,K=!1;continue}G+=n-97+10}H++,W?4==H&&(b.string+=String.fromCodePoint(G),W=!1,K=!1):2==H&&(b.string+=String.fromCodePoint(G),J=!1,K=!1);continue}}switch(n){case 13:V=!0,F.col=1;continue;case 10:case 2028:case 2029:F.line++;break;case 116:b.string+="\t";break;case 98:b.string+="\b";break;case 110:b.string+="\n";break;case 114:b.string+="\r";break;case 102:b.string+="\f";break;case 48:case 49:case 50:case 51:Q=!0,G=n-48,H=1;continue;case 120:J=!0,H=0,G=0;continue;case 117:W=!0,H=0,G=0;continue;default:b.string+=x}K=!1}else if(92===n)K?(b.string+="\\",K=!1):K=!0;else{if(V){if(V=!1,10==n){F.line++,F.col=1,K=!1;continue}F.line++,F.col=1;continue}b.string+=x}}return t}function ue(){let e;for(;(e=S)<ee.length;){x=ee.charAt(e);let n=ee.codePointAt(S++);if(n>=65536&&(ne("fault while parsing number;",n),x+=ee.charAt(S),S++),95!=n)if(F.col++,n>=48&&n<=57)M&&(R=!0),b.string+=x;else if(45==n||43==n){if(0!=b.string.length&&(!M||I||R)){j=!1,ne("fault while parsing number;",n);break}b.string+=x,I=!0}else if(46==n){if(B||C||M){j=!1,ne("fault while parsing number;",n);break}b.string+=x,B=!0}else if(120==n||98==n||111==n||88==n||66==n||79==n){if(C||"0"!=b.string){j=!1,ne("fault while parsing number;",n);break}C=!0,b.string+=x}else{if(101!=n&&69!=n){if(32==n||13==n||10==n||9==n||65279==n||44==n||125==n||93==n||58==n)break;t&&(j=!1,ne("fault while parsing number;",n));break}if(M){j=!1,ne("fault while parsing number;",n);break}b.string+=x,M=!0}}S=e,t||S!=ee.length?(q=!1,b.value_type=u,T==d&&(X=!0)):q=!0}if(!j)return-1;for(e&&e.length?((Z=function(){var e=w.pop();return e?e.n=0:e={buf:null,n:0},e}()).buf=e,L.push(Z)):q&&(q=!1,b.value_type=u,T==d&&(X=!0),te=1);j&&(Z=L.shift());){if(S=Z.n,ee=Z.buf,U){let e=se($);e<0?j=!1:e>0&&(U=!1,j&&(b.value_type=s))}for(q&&ue();!X&&j&&S<ee.length;){if(x=ee.charAt(S),(Y=ee.codePointAt(S++))>=65536&&(x+=ee.charAt(S),S++),F.col++,N){if(1==N){if(42==Y){N=3;continue}47!=Y?(ne("fault while parsing;",Y),j=!1):N=2;continue}if(2==N){if(10==Y){N=0;continue}continue}if(3==N){if(42==Y){N=4;continue}continue}if(4==N){if(47==Y){N=0;continue}42!=Y&&(N=3);continue}}switch(Y){case 47:N||(N=1);break;case 123:if(29==D||30==D||3==T&&0==D){ne("fault while parsing; getting field name unexpected ",Y),j=!1;break}{let e=y();b.value_type=l;let t={};T==d?_=O=t:4==T&&(O[b.name]=t),e.context=T,e.elements=O,e.element_array=A,e.name=b.name,O=t,P.push(e),re(),T=3}break;case 91:if(3==T||29==D||30==D){ne("Fault while parsing; while getting field name unexpected",Y),j=!1;break}{let e=y();b.value_type=c;let t=[];T==d?_=A=t:4==T&&(O[b.name]=t),e.context=T,e.elements=O,e.element_array=A,e.name=b.name,A=t,P.push(e),re(),T=1}break;case 58:if(3==T){if(0!=D&&29!=D&&30!=D){j=FALSE,thorwError(`fault while parsing; unquoted keyword used as object field name (state:${D})`,Y);break}D=0,b.name=b.string,b.string="",T=4,b.value_type=r}else ne(1==T?"(in array, got colon out of string):parsing fault;":"(outside any object, got colon out of string):parsing fault;",Y),j=!1;break;case 125:if(31==D&&(D=0),3==T){re();let e=P.pop();T=e.context,O=e.elements,A=e.element_array,m(e),T==d&&(X=!0)}else if(4==T){b.value_type!=r&&oe(),b.value_type=l,b.contains=O;var le=P.pop();b.name=le.name,T=le.context,O=le.elements,A=le.element_array,m(le),T==d&&(X=!0)}else ne("Fault while parsing; unexpected",Y),j=!1;E=!1;break;case 93:if(31==D&&(D=0),1==T){b.value_type!=r&&ie(),b.value_type=c,b.contains=A;le=P.pop();b.name=le.name,T=le.context,O=le.elements,A=le.element_array,m(le),T==d&&(X=!0)}else ne(`bad context ${T}; fault while parsing`,Y),j=!1;E=!1;break;case 44:31==D&&(D=0),1==T?(b.value_type==r&&(b.value_type=v),b.value_type!=r&&(ie(),re())):4==T?(T=3,b.value_type!=r&&(oe(),re())):(j=!1,ne("bad context; excessive commas while parsing;",Y)),E=!1;break;default:if(3==T)switch(Y){case 96:case 34:case 39:if(0==D){se(Y)?b.value_type=s:($=Y,U=!0)}else ne("fault while parsing; quote not at start of field name",Y);break;case 10:F.line++,F.col=1;case 13:case 32:case 9:case 65279:if(31==D){D=0,T==d&&(X=!0);break}if(0==D||30==D)break;29==D?D=30:(j=!1,ne("fault while parsing; whitepsace unexpected",Y));break;default:30==D&&(j=!1,ne("fault while parsing; character unexpected",Y)),0==D&&(D=29),b.string+=x}else switch(Y){case 96:case 34:case 39:se(Y)?(b.value_type=s,D=31):($=Y,U=!0);break;case 10:F.line++,F.col=1;case 32:case 9:case 13:case 65279:if(31==D){D=0,T==d&&(X=!0);break}if(0==D)break;29==D?D=30:(j=!1,ne("fault parsing whitespace",Y));break;case 116:0==D?D=1:27==D?D=28:(j=!1,ne("fault parsing",Y));break;case 114:1==D?D=2:(j=!1,ne("fault parsing",Y));break;case 117:2==D?D=3:9==D?D=10:0==D?D=12:(j=!1,ne("fault parsing",Y));break;case 101:3==D?(b.value_type=i,D=31):8==D?(b.value_type=o,D=31):14==D?D=15:18==D?D=19:(j=!1,ne("fault parsing",Y));break;case 110:0==D?D=9:12==D?D=13:17==D?D=18:22==D?D=23:25==D?D=26:(j=!1,ne("fault parsing",Y));break;case 100:13==D?D=14:19==D?(b.value_type=n,D=31):(j=!1,ne("fault parsing",Y));break;case 105:16==D?D=17:24==D?D=25:26==D?D=27:(j=!1,ne("fault parsing",Y));break;case 108:10==D?D=11:11==D?(b.value_type=a,D=31):6==D?D=7:(j=!1,ne("fault parsing",Y));break;case 102:0==D?D=5:15==D?D=16:23==D?D=24:(j=!1,ne("fault parsing",Y));break;case 97:5==D?D=6:20==D?D=21:(j=!1,ne("fault parsing",Y));break;case 115:7==D?D=8:(j=!1,ne("fault parsing",Y));break;case 73:0==D?D=22:(j=!1,ne("fault parsing",Y));break;case 78:0==D?D=20:21==D?(b.value_type=E?f:p,E=!1,D=31):(j=!1,ne("fault parsing",Y));break;case 121:28==D?(b.value_type=E?h:g,E=!1,D=31):(j=!1,ne("fault parsing",Y));break;case 45:0==D?E=!E:(j=!1,ne("fault parsing",Y));break;default:Y>=48&&Y<=57||43==Y||46==Y||45==Y?(C=!1,M=!1,I=!1,R=!1,B=!1,b.string=x,Z.n=S,ue()):(j=!1,ne("fault parsing",Y))}}if(X){31==D&&(D=0);break}}if(S==ee.length?(k(Z),U||q||3==T?te=0:T!=d||b.value_type==r&&!_||(X=!0,te=1)):(Z.n=S,L.unshift(Z),te=2),X)break}if(!j)return-1;if(X&&b.value_type!=r){switch(b.value_type){case u:_=ae(b.string);break;case s:_=b.string;break;case i:_=!0;break;case o:_=!1;break;case a:_=null;break;case n:_=void 0;break;case p:case f:_=NaN;break;case g:_=1/0;break;case h:_=-1/0;break;case l:case c:_=b.contains}E=!1,b.string="",b.value_type=r}return X=!1,te}}};const x=[Object.freeze(F.begin())];var S=0;F.parse=function(e,t){var n,r=S++;if(x.length<=r&&x.push(Object.freeze(F.begin())),n=x[r],"string"!=typeof e&&(e=String(e)),n.reset(),n._write(e,!0)>0){var a=n.value();"function"==typeof t&&function e(n,r){var a,i,o=n[r];if(o&&"object"==typeof o)for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(void 0!==(i=e(o,a))?o[a]=i:delete o[a]);return t.call(n,r,o)}({"":a},"");return S--,a}},F.stringify=JSON.stringify}));function u(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function l(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function c(e,t,n){if(!e.s){if(n instanceof f){if(!n.s)return void(n.o=c.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(c.bind(null,e,t),c.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var f=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,a=this.s;if(a){var i=1&a?t:n;if(i){try{c(r,1,i(this.v))}catch(e){c(r,2,e)}return r}return this}return this.o=function(e){try{var a=e.v;1&e.s?c(r,1,t?t(a):a):n?c(r,1,n(a)):c(r,2,a)}catch(e){c(r,2,e)}},r},e}();function p(e){return e instanceof f&&1&e.s}function h(e,t,n){for(var r;;){var a=e();if(p(a)&&(a=a.v),!a)return i;if(a.then){r=0;break}var i=n();if(i&&i.then){if(!p(i)){r=1;break}i=i.s}if(t){var o=t();if(o&&o.then&&!p(o)){r=2;break}}}var s=new f,u=c.bind(null,s,2);return(0===r?a.then(h):1===r?i.then(l):o.then(g)).then(void 0,u),s;function l(r){i=r;do{if(t&&(o=t())&&o.then&&!p(o))return void o.then(g).then(void 0,u);if(!(a=e())||p(a)&&!a.v)return void c(s,1,i);if(a.then)return void a.then(h).then(void 0,u);p(i=n())&&(i=i.v)}while(!i||!i.then);i.then(l).then(void 0,u)}function h(e){e?(i=n())&&i.then?i.then(l).then(void 0,u):l(i):c(s,1,i)}function g(){(a=e())?a.then?a.then(h).then(void 0,u):h(a):c(s,1,i)}}function g(e,t){return e&&e.then?e.then(t):t(e)}function v(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return v((function(){var r,a,i=!1,o=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return g(h((function(){return!i}),void 0,(function(){var s=e.shift();return l((function(){return u(o,(function(e){r=e,i=!0}))}),(function(){if(a)throw new Error(n);e.length||(a=!0),o=t(s)}))})),(function(e){return r}))}))()},b=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},y=function(e){var n,r,o=e.value,u=e.arg,l=(e.key,e.locale);if("string"==typeof o||o&&"object"===t(o)&&"nodeType"in o)return o;if(o&&"object"===t(o)){var c=Object.keys(o)[0];if(["number","date","relative","list"].includes(c)){if(Array.isArray(o[c])){var f=i(o[c],3);o=f[0],n=f[1],r=f[2]}else o=o[c];if("relative"===c)return new Intl.RelativeTimeFormat(l,r).format(o,n);if("list"===c)return o.sort(new Intl.Collator(l,r).compare),new Intl.ListFormat(l,n).format(o)}}var p=function(e){if("string"==typeof u){var t,r=u.indexOf("|");-1===r?u===e&&(n={}):u.slice(0,r)===e&&(t=u.slice(r+1),n=a({},n,{},s.parse("{"+t.replace(/^\{/,"").replace(/\}$/,"")+"}")))}return n};if("number"==typeof o)return new Intl.NumberFormat(l,p("NUMBER")).format(o);if(o&&"object"===t(o)&&"function"==typeof o.getTime)return new Intl.DateTimeFormat(l,p("DATETIME")).format(o);throw new TypeError("Unknown formatter")},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.messageStyle,r=void 0===n?"richNested":n;return"function"==typeof r?r:"richNested"===r?function(e,n){var r=e&&"object"===t(e)&&e.body,a=n.split("."),i=!1,o=r;return a.some((function(e,n,r){return!o||"object"!==t(o)||(n===r.length-1&&e in o&&o[e]&&"object"===t(o[e])&&"message"in o[e]&&"string"==typeof o[e].message&&(i={value:o[e].message,info:o[e]}),o=o[e],!1)})),i}:"rich"===r?function(e,n){var r=e&&"object"===t(e)&&e.body;return!!(r&&"object"===t(r)&&n in r&&r[n]&&"object"===t(r[n])&&"message"in r[n]&&"string"==typeof r[n].message)&&{value:r[n].message,info:r[n]}}:"plain"===r?function(e,n){var r=e&&"object"===t(e)&&e.body;return!!(r&&"object"===t(r)&&n in r&&r[n]&&"string"==typeof r[n])&&{value:r[n]}}:function(){throw new TypeError("Unknown `messageStyle` ".concat(r))}()},w=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.message,a=n.defaults,i=n.messageStyle,o=n.messageForKey,s=void 0===o?m({messageStyle:i}):o,u=n.key;if("string"!=typeof u)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");if("string"==typeof r)e=r;else if(!1===a||null==a)e=!1;else{if(!a||"object"!==t(a))throw new TypeError("Default locale strings must resolve to `false`, nullish, or an object!");(e=s({body:a},u))&&(e=e.value)}if(!1===e)throw new Error("Key value not found for key: (".concat(u,")"));return e},k=function(e){var n=e.string,r=e.dom,a=e.usedKeys,o=e.substitutions,s=e.allSubstitutions,u=e.locale,l=e.missingSuppliedFormatters,c=e.checkExtraSuppliedFormatters,f=/(\\*)\{((?:(?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\\\})*?)(?:(\|)((?:[\0-\|~-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?\}/g;s&&(s=Array.isArray(s)?s:[s]);var p=function(e){var t=e.key,n=e.arg,r=o[t];return"function"==typeof r&&(r=r({arg:n,key:t})),s?r=s.reduce((function(e,r){return r({value:e,arg:n,key:t,locale:u})}),r):n&&n.match(/^(?:NUMBER|DATE)(?:\||$)/)&&(r=y({value:r,arg:n,key:t,locale:u})),r};if(!r){var h=!1,g=n.replace(f,(function(e,n,r,i,o){if(n.length%2)return n.slice(0,-2)+"{"+r+(i||"")+(o||"")+"}";if(l(r))return e;var s=p({key:r,arg:o});return h=h||s&&"object"===t(s)&&"nodeType"in s,a.push(r),n.slice(0,n.length/2)+s}));if(!h)return c(),g;a.length=0}for(var v,d=[],b=0;null!==(v=f.exec(n));){var m=i(v,5),w=m[0],k=m[1],F=m[2],x=m[3],S=m[4],D=f.lastIndex,j=D-k.length-F.length-(x||"").length-(S||"").length-2;if(j>b&&d.push(n.slice(b,j)),k.length%2)d.push(k.slice(0,-2)+"{"+F+(x||"")+(S||"")+"}"),b=D;else{if(l(F))d.push(w);else{k.length&&d.push(k.slice(0,k.length/2));var E=p({key:F,arg:S});d.push(E)}b=D,a.push(F)}}return b!==n.length&&d.push(n.slice(b)),c(),d},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,n=e.locale,r=e.allSubstitutions,a=void 0===r?[y]:r,i=e.insertNodes,s=void 0===i?k:i,u=e.substitutions,l=void 0!==u&&u,c=e.dom,f=void 0!==c&&c,p=e.forceNodeReturn,h=void 0!==p&&p,g=e.throwOnMissingSuppliedFormatters,v=void 0===g||g,d=e.throwOnExtraSuppliedFormatters,b=void 0===d||d;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var m=function(e){return h?document.createTextNode(e):e},w=[],F=function(){b&&Object.keys(l).forEach((function(e){if(!e.startsWith("-")&&!w.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},x=function(e){if(!(e.startsWith("-")||e in l)){if(v)throw new Error("Missing formatting key: ".concat(e));return!0}return!1};if(!l&&!a&&!v)return m(t);l||(l={});var S=s({string:t,dom:f,usedKeys:w,substitutions:l,allSubstitutions:a,locale:n,missingSuppliedFormatters:x,checkExtraSuppliedFormatters:F});if("string"==typeof S)return m(S);var D=document.createDocumentFragment();return D.append.apply(D,o(S)),D},x=v((function(){var e=v((function(t){if("string"!=typeof t)throw new TypeError("Non-string locale type");var n=c(p,t);if("string"!=typeof n)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return l((function(){return u(fetch(n),(function(e){if(404===e.status)throw new Error("Trying again");return u(e.json(),(function(e){return{locale:t,strings:e}}))}))}),(function(n){if("SyntaxError"===n.name)throw n;return u(g(t),e)}))})),t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.locales,r=void 0===n?navigator.languages:n,a=t.defaultLocales,i=void 0===a?["en-US"]:a,s=t.localeResolver,c=void 0===s?b:s,f=t.localesBasePath,p=void 0===f?".":f,h=t.localeMatcher,g=void 0===h?"lookup":h;if("lookup"===g)g=function(e){if(!e.includes("-"))throw new Error("Locale not available");return e.replace(/\x2D(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/,"")};else if("function"!=typeof g)throw new TypeError('`localeMatcher` must be "lookup" or a function!');return d([].concat(o(r),o(i)),e,"No matching locale found!")}));e.defaultAllSubstitutions=y,e.defaultInsertNodes=k,e.defaultLocaleResolver=b,e.findLocaleStrings=x,e.getDOMForLocaleString=F,e.getMessageForKeyByStyle=m,e.getStringFromMessageAndDefaults=w,e.i18n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.locales,r=e.defaultLocales,i=e.localesBasePath,o=e.localeResolver,s=e.localeMatcher,l=e.messageStyle,c=e.allSubstitutions,f=e.insertNodes,p=e.defaults,h=e.substitutions,g=e.dom,v=void 0!==g&&g,d=e.forceNodeReturn,b=void 0!==d&&d,y=e.throwOnMissingSuppliedFormatters,k=void 0===y||y,S=e.throwOnExtraSuppliedFormatters,D=void 0===S||S;return u(x({locales:n,defaultLocales:r,localeResolver:o,localesBasePath:i,localeMatcher:s}),(function(e){var n=e.strings,r=e.locale;if(!n||"object"!==t(n))throw new TypeError("Locale strings must be an object!");var i=m({messageStyle:l});return function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o.allSubstitutions,u=void 0===s?c:s,l=o.defaults,g=void 0===l?p:l,d=o.dom,y=void 0===d?v:d,m=o.forceNodeReturn,x=void 0===m?b:m,S=o.throwOnMissingSuppliedFormatters,j=void 0===S?k:S,E=o.throwOnExtraSuppliedFormatters,_=void 0===E?D:E,O=i(n,e),A=w({message:O&&O.value||!1,defaults:g,messageForKey:i,key:e});return F({string:A,locale:r,allSubstitutions:u,insertNodes:f,substitutions:a({},h,{},t),dom:y,forceNodeReturn:x,throwOnMissingSuppliedFormatters:j,throwOnExtraSuppliedFormatters:_})}}))},e.promiseChainForValues=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
